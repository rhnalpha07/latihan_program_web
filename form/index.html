<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Kontak</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="style.css" />
    <style>
      .menu {
        margin-bottom: 20px;
        display: flex;
        gap: 10px;
      }

      .menu-button {
        padding: 10px 20px;
        background: white;
        color: var(--primary-color);
        text-decoration: none;
        border-radius: 8px;
        font-weight: 500;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s ease;
      }

      .menu-button:hover {
        background: var(--primary-color);
        color: white;
        transform: translateY(-2px);
      }

      .menu-button.active {
        background: var(--primary-color);
        color: white;
      }

      /* Paper Plane Animation */
      .plane-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9999;
        display: none;
      }

      .paper-plane {
        position: absolute;
        top: 50%;
        left: -100px;
        font-size: 40px;
        color: var(--primary-color);
        transform-origin: center;
        animation: fly-plane 3s ease-in-out forwards;
      }

      @keyframes fly-plane {
        0% {
          transform: translate(0, 0) rotate(0deg);
          opacity: 0;
        }
        10% {
          opacity: 1;
        }
        45% {
          transform: translate(45vw, -100px) rotate(-15deg);
        }
        50% {
          transform: translate(50vw, -80px) rotate(0deg);
        }
        55% {
          transform: translate(55vw, -100px) rotate(15deg);
        }
        90% {
          opacity: 1;
        }
        100% {
          transform: translate(120vw, -200px) rotate(25deg);
          opacity: 0;
        }
      }

      /* Add a trail effect */
      .paper-plane::after {
        content: '';
        position: absolute;
        top: 50%;
        left: -20px;
        width: 50px;
        height: 2px;
        background: linear-gradient(to left, var(--primary-color), transparent);
        transform: translateY(-50%);
        opacity: 0.5;
      }
    </style>
  </head>
  <body>
    <!-- Glass background shapes -->
    <div class="glass-shapes">
      <div class="shape shape-1"></div>
      <div class="shape shape-2"></div>
      <div class="shape shape-3"></div>
    </div>

    <div class="container">
      <div class="menu glass-effect">
        <a href="index.html" class="menu-button active">
          <i class="fas fa-paper-plane"></i> Form Kontak
        </a>
        <a href="view_data.php" class="menu-button">
          <i class="fas fa-table"></i> Lihat Data
        </a>
      </div>

      <div class="content-wrapper glass-effect">
        <h2><i class="fas fa-paper-plane"></i> Form Kontak</h2>
        
        <form id="contactForm">
          <div class="form-group glass-effect">
            <label for="nama">
              <i class="fas fa-user"></i> Nama
            </label>
            <input type="text" id="nama" name="nama" required placeholder="Masukkan nama Anda" />
          </div>

          <div class="form-group glass-effect">
            <label for="email">
              <i class="fas fa-envelope"></i> Email
            </label>
            <input type="email" id="email" name="email" required placeholder="Masukkan email Anda" />
          </div>

          <div class="form-group glass-effect">
            <label for="pesan">
              <i class="fas fa-comment"></i> Pesan
            </label>
            <textarea id="pesan" name="pesan" rows="4" required placeholder="Tulis pesan Anda di sini"></textarea>
          </div>

          <button type="submit" class="glass-button">
            <i class="fas fa-paper-plane"></i> Kirim Pesan
          </button>
        </form>
        <div id="message"></div>
      </div>
    </div>

    <!-- Paper plane animation container -->
    <div class="plane-container">
      <div class="paper-plane">
        <i class="fas fa-paper-plane"></i>
      </div>
    </div>

    <script>
      document.getElementById('contactForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const formData = new FormData(this);
        const messageDiv = document.getElementById('message');
        const submitButton = this.querySelector('button[type="submit"]');
        
        try {
          // Disable button and show loading state
          submitButton.disabled = true;
          submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Mengirim...';
          
          const response = await fetch('process.php', {
            method: 'POST',
            body: formData
          });
          
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          
          const result = await response.json();
          
          if (result.success) {
            messageDiv.className = 'success glass-effect';
            this.reset(); // Clear form on success
            // Trigger the plane animation on success
            animatePlane();
          } else {
            messageDiv.className = 'error glass-effect';
          }
          messageDiv.textContent = result.message;
          
        } catch (error) {
          messageDiv.textContent = 'Error: ' + error.message;
          messageDiv.className = 'error glass-effect';
          console.error('Error:', error);
        } finally {
          // Re-enable button and restore original text
          submitButton.disabled = false;
          submitButton.innerHTML = '<i class="fas fa-paper-plane"></i> Kirim Pesan';
        }
      });

      function animatePlane() {
        const planeContainer = document.querySelector('.plane-container');
        planeContainer.style.display = 'block';
        
        setTimeout(() => {
          planeContainer.style.display = 'none';
        }, 3000);
      }
    </script>
  </body>
</html>
